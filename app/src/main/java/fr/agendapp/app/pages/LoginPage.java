package fr.agendapp.app.pages;

import android.app.Activity;
import android.content.Intent;
import android.content.SharedPreferences;
import android.os.Bundle;
import android.util.Log;

import fr.agendapp.app.App;
import fr.agendapp.app.factories.SyncFactory;

public class LoginPage extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        Log.i(App.TAG, "LoginPage created");
        // TODO formulaire
        SyncFactory.login(this, "test@agendapp.fr", "test");
    }

    public void onLogin(String token, String message) {
        // TODO Notification.add message
        SharedPreferences preferences = getSharedPreferences(App.TAG, MODE_PRIVATE);
        SharedPreferences.Editor editor = preferences.edit();
        editor.putString("token", token);

        // TODO remplacer par User.init
        editor.putString("user", "{\"id\":19,\"prenom\":\"Utilisateur\",\"nom\":\"Test\",\"email\":\"test@agendapp.fr\",\"notifs\":-1,\"rappels\":1,\"maiâ€¦");
        editor.putString("devoirs", "[{\"id\":3167,\"user\":19,\"date\":\"2017-03-11T19:00:00.000+02:00\",\"auteur\":\"UtilisateurTest\",\"matiere\":\"Chimie\",\"matiere_c\":\"33CC33\",\"texte\":\"Test de devoir N\\u00b02\",\"nb_fait\":0,\"fait\":0,\"flag\":0,\"commentaires\":[],\"pjs\":[]},{\"id\":3166,\"user\":19,\"date\":\"2017-03-10T19:00:00.000+02:00\",\"auteur\":\"UtilisateurTest\",\"matiere\":\"Philosophie\",\"matiere_c\":\"FF0066\",\"texte\":\"Test\",\"nb_fait\":0,\"fait\":0,\"flag\":0,\"commentaires\":[],\"pjs\":[]},{\"id\":186,\"user\":19,\"date\":\"2017-03-08T19:00:00.000+02:00\",\"auteur\":\"UtilisateurTest\",\"matiere\":\"Maths\",\"matiere_c\":\"0066CC\",\"texte\":\"Exercices 8 et 9 du polycopi\\u00e9\",\"nb_fait\":0,\"fait\":0,\"flag\":0,\"commentaires\":[],\"pjs\":[]},{\"id\":184,\"user\":19,\"date\":\"2017-03-06T19:00:00.000+02:00\",\"auteur\":\"UtilisateurTest\",\"matiere\":\"Chimie\",\"matiere_c\":\"33CC33\",\"texte\":\"Exercice 20 page 40\",\"nb_fait\":0,\"fait\":0,\"flag\":0,\"commentaires\":[],\"pjs\":[]},{\"id\":185,\"user\":19,\"date\":\"2017-03-06T19:00:00.000+02:00\",\"auteur\":\"UtilisateurTest\",\"matiere\":\"Mes t\\u00e2ches persos\",\"matiere_c\":null,\"texte\":\"Expos\\u00e9 Anglais\",\"nb_fait\":0,\"fait\":0,\"flag\":0,\"commentaires\":[],\"pjs\":[]},{\"id\":90,\"user\":19,\"date\":\"2016-12-30T19:00:00.000+02:00\",\"auteur\":\"UtilisateurTest\",\"matiere\":\"Mes t\\u00e2ches persos\",\"matiere_c\":null,\"texte\":\"test\",\"nb_fait\":1,\"fait\":1,\"flag\":0,\"commentaires\":[],\"pjs\":[]},{\"id\":127,\"user\":19,\"date\":\"2016-12-24T19:00:00.000+02:00\",\"auteur\":\"UtilisateurTest\",\"matiere\":\"Mes t\\u00e2ches persos\",\"matiere_c\":null,\"texte\":\"Test sync\",\"nb_fait\":1,\"fait\":1,\"flag\":0,\"commentaires\":[],\"pjs\":[]},{\"id\":115,\"user\":19,\"date\":\"2016-12-23T19:00:00.000+02:00\",\"auteur\":\"UtilisateurTest\",\"matiere\":\"Mes t\\u00e2ches persos\",\"matiere_c\":null,\"texte\":\"Test\",\"nb_fait\":0,\"fait\":0,\"flag\":0,\"commentaires\":[],\"pjs\":[]},{\"id\":110,\"user\":19,\"date\":\"2016-12-23T19:00:00.000+02:00\",\"auteur\":\"UtilisateurTest\",\"matiere\":\"Mes t\\u00e2ches persos\",\"matiere_c\":null,\"texte\":\"Test\",\"nb_fait\":1,\"fait\":1,\"flag\":0,\"commentaires\":[],\"pjs\":[]},{\"id\":112,\"user\":19,\"date\":\"2016-12-23T19:00:00.000+02:00\",\"auteur\":\"UtilisateurTest\",\"matiere\":\"Mes t\\u00e2ches persos\",\"matiere_c\":null,\"texte\":\"test\",\"nb_fait\":1,\"fait\":1,\"flag\":0,\"commentaires\":[],\"pjs\":[]},{\"id\":51,\"user\":19,\"date\":\"2016-11-03T19:00:00.000+02:00\",\"auteur\":\"UtilisateurTest\",\"matiere\":\"Mes t\\u00e2ches persos\",\"matiere_c\":null,\"texte\":\"Enlever le order by done \\/ undone\",\"nb_fait\":1,\"fait\":1,\"flag\":0,\"commentaires\":[{\"id\":45,\"user\":19,\"auteur\":\"UtilisateurTest\",\"date\":\"2016-11-01T02:25:42.000+02:00\",\"texte\":\"Parce que cest insupportable !\",\"pjs\":[]},{\"id\":46,\"user\":19,\"auteur\":\"UtilisateurTest\",\"date\":\"2016-11-01T02:26:13.000+02:00\",\"texte\":\"Correction automatique activee quand remplissage dun commentaire ou dun devoir ?\",\"pjs\":[]},{\"id\":47,\"user\":19,\"auteur\":\"UtilisateurTest\",\"date\":\"2016-11-01T02:27:31.000+02:00\",\"texte\":\"Griser le &quot;masquer les devoirs termin\\u00e9s&quot;\",\"pjs\":[]},{\"id\":48,\"user\":19,\"auteur\":\"UtilisateurTest\",\"date\":\"2016-11-01T02:28:19.000+02:00\",\"texte\":\"Changement d'heure...\",\"pjs\":[]}],\"pjs\":[]},{\"id\":40,\"user\":19,\"date\":\"2016-11-01T19:00:00.000+02:00\",\"auteur\":\"UtilisateurTest\",\"matiere\":\"Mes t\\u00e2ches persos\",\"matiere_c\":null,\"texte\":\"Test\",\"nb_fait\":0,\"fait\":0,\"flag\":3,\"commentaires\":[{\"id\":42,\"user\":19,\"auteur\":\"UtilisateurTest\",\"date\":\"2016-10-31T19:47:47.000+02:00\",\"texte\":11111,\"pjs\":[]},{\"id\":43,\"user\":19,\"auteur\":\"UtilisateurTest\",\"date\":\"2016-10-31T20:53:00.000+02:00\",\"texte\":2222,\"pjs\":[]}],\"pjs\":[]},{\"id\":41,\"user\":19,\"date\":\"2016-11-01T19:00:00.000+02:00\",\"auteur\":\"UtilisateurTest\",\"matiere\":\"Mes t\\u00e2ches persos\",\"matiere_c\":null,\"texte\":\"Nec piget dicere avide magis hanc insulam populum Romanum invasisse quam iuste. Ptolomaeo enim rege foederato nobis et socio ob aerarii nostri angustias iusso sine ulla culpa proscribi ideoque hausto veneno voluntaria morte deleto et tributaria facta est et velut hostiles eius exuviae classi inpositae in urbem advectae sunt per Catonem, nunc repetetur ordo gestorum.\",\"nb_fait\":0,\"fait\":0,\"flag\":0,\"commentaires\":[],\"pjs\":[]},{\"id\":33,\"user\":19,\"date\":\"2016-10-31T19:00:00.000+02:00\",\"auteur\":\"UtilisateurTest\",\"matiere\":\"Mes t\\u00e2ches persos\",\"matiere_c\":null,\"texte\":\"T\\u00e2che personnelle\",\"nb_fait\":0,\"fait\":0,\"flag\":2,\"commentaires\":[{\"id\":32,\"user\":19,\"auteur\":\"UtilisateurTest\",\"date\":\"2016-10-30T23:19:07.000+02:00\",\"texte\":1111,\"pjs\":[]},{\"id\":33,\"user\":19,\"auteur\":\"UtilisateurTest\",\"date\":\"2016-10-30T23:19:12.000+02:00\",\"texte\":2222,\"pjs\":[]},{\"id\":34,\"user\":19,\"auteur\":\"UtilisateurTest\",\"date\":\"2016-10-30T23:20:35.000+02:00\",\"texte\":\"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.\",\"pjs\":[]},{\"id\":38,\"user\":19,\"auteur\":\"UtilisateurTest\",\"date\":\"2016-10-31T18:15:10.000+02:00\",\"texte\":4444,\"pjs\":[]},{\"id\":39,\"user\":19,\"auteur\":\"UtilisateurTest\",\"date\":\"2016-10-31T18:15:45.000+02:00\",\"texte\":5555,\"pjs\":[]},{\"id\":40,\"user\":19,\"auteur\":\"UtilisateurTest\",\"date\":\"2016-10-31T18:15:49.000+02:00\",\"texte\":6666,\"pjs\":[]},{\"id\":66,\"user\":19,\"auteur\":\"UtilisateurTest\",\"date\":\"2016-12-22T01:02:47.000+02:00\",\"texte\":7777,\"pjs\":[]}],\"pjs\":[{\"user\":19,\"auteur\":\"UtilisateurTest\",\"file\":\"1477772976.png\",\"title\":\"317px-Develstages+fr.svg.png\"}]}]");
        editor.putString("archives", "[{\"id\":3167,\"user\":19,\"date\":\"2017-03-11T19:00:00.000+02:00\",\"auteur\":\"UtilisateurTest\",\"matiere\":\"Chimie\",\"matiere_c\":\"33CC33\",\"texte\":\"Test de devoir N\\u00b02\",\"nb_fait\":0,\"fait\":0,\"flag\":0,\"commentaires\":[],\"pjs\":[]},{\"id\":3166,\"user\":19,\"date\":\"2017-03-10T19:00:00.000+02:00\",\"auteur\":\"UtilisateurTest\",\"matiere\":\"Philosophie\",\"matiere_c\":\"FF0066\",\"texte\":\"Test\",\"nb_fait\":0,\"fait\":0,\"flag\":0,\"commentaires\":[],\"pjs\":[]},{\"id\":186,\"user\":19,\"date\":\"2017-03-08T19:00:00.000+02:00\",\"auteur\":\"UtilisateurTest\",\"matiere\":\"Maths\",\"matiere_c\":\"0066CC\",\"texte\":\"Exercices 8 et 9 du polycopi\\u00e9\",\"nb_fait\":0,\"fait\":0,\"flag\":0,\"commentaires\":[],\"pjs\":[]},{\"id\":184,\"user\":19,\"date\":\"2017-03-06T19:00:00.000+02:00\",\"auteur\":\"UtilisateurTest\",\"matiere\":\"Chimie\",\"matiere_c\":\"33CC33\",\"texte\":\"Exercice 20 page 40\",\"nb_fait\":0,\"fait\":0,\"flag\":0,\"commentaires\":[],\"pjs\":[]},{\"id\":185,\"user\":19,\"date\":\"2017-03-06T19:00:00.000+02:00\",\"auteur\":\"UtilisateurTest\",\"matiere\":\"Mes t\\u00e2ches persos\",\"matiere_c\":null,\"texte\":\"Expos\\u00e9 Anglais\",\"nb_fait\":0,\"fait\":0,\"flag\":0,\"commentaires\":[],\"pjs\":[]},{\"id\":90,\"user\":19,\"date\":\"2016-12-30T19:00:00.000+02:00\",\"auteur\":\"UtilisateurTest\",\"matiere\":\"Mes t\\u00e2ches persos\",\"matiere_c\":null,\"texte\":\"test\",\"nb_fait\":1,\"fait\":1,\"flag\":0,\"commentaires\":[],\"pjs\":[]},{\"id\":127,\"user\":19,\"date\":\"2016-12-24T19:00:00.000+02:00\",\"auteur\":\"UtilisateurTest\",\"matiere\":\"Mes t\\u00e2ches persos\",\"matiere_c\":null,\"texte\":\"Test sync\",\"nb_fait\":1,\"fait\":1,\"flag\":0,\"commentaires\":[],\"pjs\":[]},{\"id\":115,\"user\":19,\"date\":\"2016-12-23T19:00:00.000+02:00\",\"auteur\":\"UtilisateurTest\",\"matiere\":\"Mes t\\u00e2ches persos\",\"matiere_c\":null,\"texte\":\"Test\",\"nb_fait\":0,\"fait\":0,\"flag\":0,\"commentaires\":[],\"pjs\":[]},{\"id\":110,\"user\":19,\"date\":\"2016-12-23T19:00:00.000+02:00\",\"auteur\":\"UtilisateurTest\",\"matiere\":\"Mes t\\u00e2ches persos\",\"matiere_c\":null,\"texte\":\"Test\",\"nb_fait\":1,\"fait\":1,\"flag\":0,\"commentaires\":[],\"pjs\":[]},{\"id\":112,\"user\":19,\"date\":\"2016-12-23T19:00:00.000+02:00\",\"auteur\":\"UtilisateurTest\",\"matiere\":\"Mes t\\u00e2ches persos\",\"matiere_c\":null,\"texte\":\"test\",\"nb_fait\":1,\"fait\":1,\"flag\":0,\"commentaires\":[],\"pjs\":[]},{\"id\":51,\"user\":19,\"date\":\"2016-11-03T19:00:00.000+02:00\",\"auteur\":\"UtilisateurTest\",\"matiere\":\"Mes t\\u00e2ches persos\",\"matiere_c\":null,\"texte\":\"Enlever le order by done \\/ undone\",\"nb_fait\":1,\"fait\":1,\"flag\":0,\"commentaires\":[{\"id\":45,\"user\":19,\"auteur\":\"UtilisateurTest\",\"date\":\"2016-11-01T02:25:42.000+02:00\",\"texte\":\"Parce que cest insupportable !\",\"pjs\":[]},{\"id\":46,\"user\":19,\"auteur\":\"UtilisateurTest\",\"date\":\"2016-11-01T02:26:13.000+02:00\",\"texte\":\"Correction automatique activee quand remplissage dun commentaire ou dun devoir ?\",\"pjs\":[]},{\"id\":47,\"user\":19,\"auteur\":\"UtilisateurTest\",\"date\":\"2016-11-01T02:27:31.000+02:00\",\"texte\":\"Griser le &quot;masquer les devoirs termin\\u00e9s&quot;\",\"pjs\":[]},{\"id\":48,\"user\":19,\"auteur\":\"UtilisateurTest\",\"date\":\"2016-11-01T02:28:19.000+02:00\",\"texte\":\"Changement d'heure...\",\"pjs\":[]}],\"pjs\":[]},{\"id\":40,\"user\":19,\"date\":\"2016-11-01T19:00:00.000+02:00\",\"auteur\":\"UtilisateurTest\",\"matiere\":\"Mes t\\u00e2ches persos\",\"matiere_c\":null,\"texte\":\"Test\",\"nb_fait\":0,\"fait\":0,\"flag\":3,\"commentaires\":[{\"id\":42,\"user\":19,\"auteur\":\"UtilisateurTest\",\"date\":\"2016-10-31T19:47:47.000+02:00\",\"texte\":11111,\"pjs\":[]},{\"id\":43,\"user\":19,\"auteur\":\"UtilisateurTest\",\"date\":\"2016-10-31T20:53:00.000+02:00\",\"texte\":2222,\"pjs\":[]}],\"pjs\":[]},{\"id\":41,\"user\":19,\"date\":\"2016-11-01T19:00:00.000+02:00\",\"auteur\":\"UtilisateurTest\",\"matiere\":\"Mes t\\u00e2ches persos\",\"matiere_c\":null,\"texte\":\"Nec piget dicere avide magis hanc insulam populum Romanum invasisse quam iuste. Ptolomaeo enim rege foederato nobis et socio ob aerarii nostri angustias iusso sine ulla culpa proscribi ideoque hausto veneno voluntaria morte deleto et tributaria facta est et velut hostiles eius exuviae classi inpositae in urbem advectae sunt per Catonem, nunc repetetur ordo gestorum.\",\"nb_fait\":0,\"fait\":0,\"flag\":0,\"commentaires\":[],\"pjs\":[]},{\"id\":33,\"user\":19,\"date\":\"2016-10-31T19:00:00.000+02:00\",\"auteur\":\"UtilisateurTest\",\"matiere\":\"Mes t\\u00e2ches persos\",\"matiere_c\":null,\"texte\":\"T\\u00e2che personnelle\",\"nb_fait\":0,\"fait\":0,\"flag\":2,\"commentaires\":[{\"id\":32,\"user\":19,\"auteur\":\"UtilisateurTest\",\"date\":\"2016-10-30T23:19:07.000+02:00\",\"texte\":1111,\"pjs\":[]},{\"id\":33,\"user\":19,\"auteur\":\"UtilisateurTest\",\"date\":\"2016-10-30T23:19:12.000+02:00\",\"texte\":2222,\"pjs\":[]},{\"id\":34,\"user\":19,\"auteur\":\"UtilisateurTest\",\"date\":\"2016-10-30T23:20:35.000+02:00\",\"texte\":\"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.\",\"pjs\":[]},{\"id\":38,\"user\":19,\"auteur\":\"UtilisateurTest\",\"date\":\"2016-10-31T18:15:10.000+02:00\",\"texte\":4444,\"pjs\":[]},{\"id\":39,\"user\":19,\"auteur\":\"UtilisateurTest\",\"date\":\"2016-10-31T18:15:45.000+02:00\",\"texte\":5555,\"pjs\":[]},{\"id\":40,\"user\":19,\"auteur\":\"UtilisateurTest\",\"date\":\"2016-10-31T18:15:49.000+02:00\",\"texte\":6666,\"pjs\":[]},{\"id\":66,\"user\":19,\"auteur\":\"UtilisateurTest\",\"date\":\"2016-12-22T01:02:47.000+02:00\",\"texte\":7777,\"pjs\":[]}],\"pjs\":[{\"user\":19,\"auteur\":\"UtilisateurTest\",\"file\":\"1477772976.png\",\"title\":\"317px-Develstages+fr.svg.png\"}]}]");

        editor.apply();
        Intent page = new Intent(LoginPage.this, App.class);
        startActivity(page);
    }

    public void onErrorLogin(String message) {
        // TODO
        Log.w(App.TAG, "message : " + message);
    }
}